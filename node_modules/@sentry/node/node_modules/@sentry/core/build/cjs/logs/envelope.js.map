{"version":3,"file":"envelope.js","sources":["../../../src/logs/envelope.ts"],"sourcesContent":["import type { DsnComponents, SdkMetadata, SerializedOtelLog } from '../types-hoist';\nimport type { OtelLogEnvelope, OtelLogItem } from '../types-hoist/envelope';\nimport { dsnToString } from '../utils-hoist/dsn';\nimport { createEnvelope } from '../utils-hoist/envelope';\n\n/**\n * Creates OTEL log envelope item for a serialized OTEL log.\n *\n * @param log - The serialized OTEL log to include in the envelope.\n * @returns The created OTEL log envelope item.\n */\nexport function createOtelLogEnvelopeItem(log: SerializedOtelLog): OtelLogItem {\n  return [\n    {\n      type: 'otel_log',\n    },\n    log,\n  ];\n}\n\n/**\n * Creates an envelope for a list of logs.\n *\n * @param logs - The logs to include in the envelope.\n * @param metadata - The metadata to include in the envelope.\n * @param tunnel - The tunnel to include in the envelope.\n * @param dsn - The DSN to include in the envelope.\n * @returns The created envelope.\n */\nexport function createOtelLogEnvelope(\n  logs: Array<SerializedOtelLog>,\n  metadata?: SdkMetadata,\n  tunnel?: string,\n  dsn?: DsnComponents,\n): OtelLogEnvelope {\n  const headers: OtelLogEnvelope[0] = {};\n\n  if (metadata?.sdk) {\n    headers.sdk = {\n      name: metadata.sdk.name,\n      version: metadata.sdk.version,\n    };\n  }\n\n  if (!!tunnel && !!dsn) {\n    headers.dsn = dsnToString(dsn);\n  }\n\n  return createEnvelope<OtelLogEnvelope>(headers, logs.map(createOtelLogEnvelopeItem));\n}\n"],"names":["dsn","dsnToString","createEnvelope"],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,yBAAyB,CAAC,GAAG,EAAkC;AAC/E,EAAE,OAAO;AACT,IAAI;AACJ,MAAM,IAAI,EAAE,UAAU;AACtB,KAAK;AACL,IAAI,GAAG;AACP,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,qBAAqB;AACrC,EAAE,IAAI;AACN,EAAE,QAAQ;AACV,EAAE,MAAM;AACR,EAAEA,KAAG;AACL,EAAmB;AACnB,EAAE,MAAM,OAAO,GAAuB,EAAE;;AAExC,EAAE,IAAI,QAAQ,EAAE,GAAG,EAAE;AACrB,IAAI,OAAO,CAAC,GAAA,GAAM;AAClB,MAAM,IAAI,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI;AAC7B,MAAM,OAAO,EAAE,QAAQ,CAAC,GAAG,CAAC,OAAO;AACnC,KAAK;AACL;;AAEA,EAAE,IAAI,CAAC,CAAC,UAAU,CAAC,CAACA,KAAG,EAAE;AACzB,IAAI,OAAO,CAAC,GAAA,GAAMC,eAAW,CAACD,KAAG,CAAC;AAClC;;AAEA,EAAE,OAAOE,uBAAc,CAAkB,OAAO,EAAE,IAAI,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;AACtF;;;;;"}